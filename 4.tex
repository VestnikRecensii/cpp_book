\documentclass[book.tex]{subfiles}

%\input{common}
\begin{document}
\input{fontsize}

\chaptertitle{Операторы}

\maketitle 

\section*{Составной оператор (блок)}

Иногда бывает необходимо сгруппировать какие-то логически связанные действия. Например, программа, регулирующая уровень жидкости в емкости, при превышении критического уровня должна не только начать сливать жидкость, но и остановить закачивающий ее насос. Для группировки таких действий используется составной оператор или блок. На языке C++ и в других языках с Си-подобным синтаксисом он выглядит как заключенные в фигурные скобки \cppword{\{\}} другие операторы.

После составного оператора необязательная точка с запятой. Кроме того он формирует область видимости, что мы уже рассмотрели ранее. Составные операторы используются как тела других операторов --- например, в условиях и циклах. Однако, его можно использовать и отдельно, например, для того, чтобы логически обособить группу операторов вместе с локальными переменными.

\section*{Условный оператор}

Иногда, в зависимости от какого-то условия, нужно выполнить различные действия. Для этого используется оператор \cppword{if} (если). В дополнение к нему может использоваться оператор \cppword{else} (иначе). Код в \cppword{else} выполняется, только если условие в соответствующем \cppword{if} ложно. Выглядит это следующим образом:

\showfile{src/if.cpp}{Условный оператор}

\section*{Оператор переключения}

Оператор переключения \cppword{switch} представляет собой что-то вроде особого условного оператора. Оператор принимает выражение целого типа и последовательно сравнивает с метками (выражениями, изветными на момент компиляции). Если ни одного сопоставления не найдено, выполняется переход на метку \cppword{default} (при ее наличии). После каждой метки может стоять оператор \cppword{break} для перехода к следующей метке. Выглядит сложно? Давайте посмотрим пример:

\showfile{src/switch.cpp}{Оператор переключения}

\section*{Операторы цикла}

\fordummies{

В программировании цикл --- это конструкция, предназначенная для многократного выполнения набора команд. Допустим, нам надо напечатать числа от 1 до 10. Можно, конечно, написать 10 почти одинаковых строчек, но это и довольно некрасиво смотрится, и не очень эффективно, т.к. при копировании легко ошибиться. Кроме того, в более реальных ситуациях, например, когда надо обратиться к каждому объекту в списке, без циклов не обойтись.

}

В C++ существует 4 вида циклов --- цикл с предусловием, цикл с постусловием, цикл со счетчиком и цикл для прохода по коллекции (появился в стандарте C++11, его мы рассмотрим позже).

Цикл с предусловием, как следует из названия, содержит условие, которое проверяется \textbf{перед началом цикла}. Цикл выполняется, пока истинно это условие. Тело цикла с предусловием может не выполниться ни разу, если условие изначально ложное.

В цикле с постусловием условие проверяется \textbf{после выполнения тела цикла}. Поскольку условие проверяется после, цикл обязательно выполнится хотя бы один раз.

Цикл со счетчиком --- наверное, самый известный из всех. В нем некоторая переменная (счетчик) изменяется от заданного начального до конечного значения с некоторым шагом, а для каждого значения счетчика тело цикла выполняется один раз.

\showfile{src/loops.cpp}{Виды циклов}

\section*{Выход из цикла}

Иногда нужно досрочно выйти из цикла. Скажем, мы ищем в списке книг нужную нам. Как только она найдена, дальнейший поиск уже не имеет смысла и будет лишней тратой времени. Для этого используется уже известный нам оператор \cppword{break}, который прерывает выполнение цикла:

\showfile{src/break.cpp}{Досрочный выход из цикла}

А бывает наоборт, нужно продолжить выполнение цикла, досрочно перейдя на следующую итерацию. Тут поможет оператор \cppword{continue}:

\showfile{src/continue.cpp}{Переход на следующую итерацию цикла}

К сожалению, в C++ и \cppword{break}, и \cppword{continue} связаны только с ближайшим циклом, поэтому организовать с их помощью выход из нескольких вложенных циклов не получится. Там придется использовать условные флаги или оператор перехода.

\section*{Оператор перехода}

Оператор безусловного перехода \cppword{goto} предназначен для перехода к месту в коде, помеченному соответствующей меткой. Можно переходить как вперед, так и назад по коду, но нельзя из одной функции перейти в другую.

Этот оператор является, наверное, самым неоднозначным средством. В некоторых языках от его использования отказались, сочтя нежелательным. Основная причина такого поступка --- при использовании \cppword{goto} код быстро превращается в <<спагетти>> и теряет структурированность. 

\textbf{Пожалуйста, избегайте использования \cppword{goto} и подобного кода:}

\showfile{src/bad_goto.cpp}{Пример плохого использования goto}

Однако, можно использовать его в следующих случаях:

\begin{itemize}
\item Метка должна обязательно находиться ниже по коду, чем оператор перехода. Переходить вперед можно, назад --- нельзя.
\item Между меткой и переходом должно находиться очень небольшое количество кода. Переходить на 10 строк вперед можно, на 80 --- нет.
\item Для выхода из нескольких вложенных циклов можно использовать \cppword{goto}, если при этом соблюдаются два предыдущих правила.
\end{itemize}

\showfile{src/good_goto.cpp}{Пример хорошего использования goto}

Как и любой работающий инструмент, в умелых руках \cppword{goto} допустим. Но нужно использовать его только в тех случаях, когда это оправдано, а отказ от использования приведет к усложнению программы.

\end{document}
